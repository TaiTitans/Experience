
---
Trong Java, `Map` lÃ  má»™t trong nhá»¯ng cáº¥u trÃºc dá»¯ liá»‡u quan trá»ng nháº¥t, giÃºp lÆ°u trá»¯ dá»¯ liá»‡u theo cáº·p **Key-Value**. Äá»ƒ há»c chuyÃªn sÃ¢u vá» `Map`, chÃºng ta sáº½ Ä‘i qua cÃ¡c pháº§n:

## ğŸ”¹ 1. Tá»•ng Quan `Map` Trong Java

### ğŸ“Œ `Map` LÃ  GÃ¬?

- `Map<K, V>` lÃ  má»™t **interface** trong `java.util`, khÃ´ng káº¿ thá»«a tá»« `Collection`, nhÆ°ng váº«n lÃ  má»™t pháº§n cá»§a Java Collection Framework.
- NÃ³ lÆ°u trá»¯ dá»¯ liá»‡u theo cáº·p `Key` - `Value`, trong Ä‘Ã³:
    - `Key`: KhÃ´ng Ä‘Æ°á»£c trÃ¹ng láº·p.
    - `Value`: CÃ³ thá»ƒ trÃ¹ng láº·p.

### ğŸ“Œ CÃ¡c Triá»ƒn Khai ChÃ­nh Cá»§a `Map`

|Loáº¡i `Map`|Äáº·c Ä‘iá»ƒm|
|---|---|
|`HashMap`|KhÃ´ng Ä‘áº£m báº£o thá»© tá»±, hiá»‡u suáº¥t cao (`O(1)`).|
|`LinkedHashMap`|Duy trÃ¬ thá»© tá»± chÃ¨n.|
|`TreeMap`|Sáº¯p xáº¿p theo key (`O(log n)`).|
|`ConcurrentHashMap`|Há»— trá»£ Ä‘a luá»“ng mÃ  khÃ´ng cáº§n Ä‘á»“ng bá»™ hÃ³a toÃ n bá»™.|
|`WeakHashMap`|Tá»± Ä‘á»™ng xÃ³a key náº¿u khÃ´ng cÃ²n tham chiáº¿u.|
## ğŸ”¹ 2. CÃ¡ch Sá»­ Dá»¥ng `Map`

### ğŸŸ¢ 2.1. Khai BÃ¡o VÃ  Khá»Ÿi Táº¡o
```java
import java.util.*;

public class MapExample {
    public static void main(String[] args) {
        Map<String, Integer> map = new HashMap<>();

        map.put("Alice", 85);
        map.put("Bob", 90);
        map.put("Charlie", 78);

        System.out.println(map); // {Alice=85, Bob=90, Charlie=78}
    }
}
```

ğŸŸ¢ 2.2. Truy Xuáº¥t GiÃ¡ Trá»‹ Theo Key
```java
System.out.println("Alice's score: " + map.get("Alice")); // 85
```
ğŸŸ¢ 2.3. Kiá»ƒm Tra Key Hoáº·c Value
```java
System.out.println(map.containsKey("Bob"));    // true
System.out.println(map.containsValue(100));    // false
```

ğŸŸ¢ 2.4. Duyá»‡t Qua `Map`
```java
for (Map.Entry<String, Integer> entry : map.entrySet()) {
    System.out.println(entry.getKey() + " => " + entry.getValue());
}

// Hoáº·c dÃ¹ng forEach (Java 8+)
map.forEach((k, v) -> System.out.println(k + " -> " + v));
```
## ğŸ”¹ 3. So SÃ¡nh `HashMap`, `LinkedHashMap`, `TreeMap`

### ğŸŸ¢ `HashMap` (Truy xuáº¥t nhanh nháº¥t)
```java
Map<String, Integer> hashMap = new HashMap<>();
hashMap.put("Banana", 2);
hashMap.put("Apple", 5);
hashMap.put("Orange", 3);
System.out.println("HashMap: " + hashMap); // KhÃ´ng theo thá»© tá»±
```
ğŸŸ¢ `LinkedHashMap` (Duy trÃ¬ thá»© tá»± chÃ¨n)
```java
Map<String, Integer> linkedHashMap = new LinkedHashMap<>(hashMap);
System.out.println("LinkedHashMap: " + linkedHashMap);
```
ğŸŸ¢ `TreeMap` (Sáº¯p xáº¿p theo key)
```java
Map<String, Integer> treeMap = new TreeMap<>(hashMap);
System.out.println("TreeMap: " + treeMap);
```
## ğŸ”¹ 4. Xá»­ LÃ½ Äa Luá»“ng Vá»›i `Map`

### ğŸŸ¢ 4.1. `Collections.synchronizedMap()`
```java
import java.util.Collections;
import java.util.Map;
import java.util.HashMap;

public class SynchronizedMapExample {
    public static void main(String[] args) {
        Map<String, Integer> syncMap = Collections.synchronizedMap(new HashMap<>());
        syncMap.put("A", 1);
        syncMap.put("B", 2);

        synchronized (syncMap) {
            for (String key : syncMap.keySet()) {
                System.out.println(key + " => " + syncMap.get(key));
            }
        }
    }
}
```

ğŸŸ¢ 4.2. `ConcurrentHashMap`
```java
import java.util.concurrent.ConcurrentHashMap;

public class ConcurrentMapExample {
    public static void main(String[] args) {
        ConcurrentHashMap<String, Integer> concurrentMap = new ConcurrentHashMap<>();
        concurrentMap.put("X", 100);
        concurrentMap.put("Y", 200);

        concurrentMap.forEach((key, value) -> System.out.println(key + " => " + value));
    }
}
```

âœ… `ConcurrentHashMap` tá»‘t hÆ¡n vÃ¬ chá»‰ khÃ³a tá»«ng pháº§n, khÃ´ng khÃ³a toÃ n bá»™ `Map`.


## ğŸ”¹ 5. Custom Key Trong `Map`

### ğŸŸ¢ Khi DÃ¹ng Object LÃ m Key

Náº¿u `Key` lÃ  má»™t class tÃ¹y chá»‰nh, pháº£i override `hashCode()` vÃ  `equals()` Ä‘á»ƒ Ä‘áº£m báº£o Ä‘Ãºng logic tÃ¬m kiáº¿m.
```java
import java.util.HashMap;
import java.util.Map;
import java.util.Objects;

class Student {
    String name;
    int id;

    public Student(String name, int id) {
        this.name = name;
        this.id = id;
    }

    @Override
    public boolean equals(Object obj) {
        if (this == obj) return true;
        if (obj == null || getClass() != obj.getClass()) return false;
        Student student = (Student) obj;
        return id == student.id && Objects.equals(name, student.name);
    }

    @Override
    public int hashCode() {
        return Objects.hash(name, id);
    }
}

public class CustomKeyExample {
    public static void main(String[] args) {
        Map<Student, String> studentMap = new HashMap<>();
        studentMap.put(new Student("John", 101), "A+");
        studentMap.put(new Student("Alice", 102), "B");

        System.out.println(studentMap.get(new Student("John", 101))); // A+
    }
}
```

Náº¿u khÃ´ng override `hashCode()` vÃ  `equals()`, Map sáº½ khÃ´ng thá»ƒ tÃ¬m Ä‘Ãºng key.


## ğŸ”¹ 6. Stream API Vá»›i `Map`

### ğŸŸ¢ Lá»c Dá»¯ Liá»‡u
```java
import java.util.*;
import java.util.stream.Collectors;

public class MapStreamExample {
    public static void main(String[] args) {
        Map<String, Integer> scores = new HashMap<>();
        scores.put("Alice", 90);
        scores.put("Bob", 85);
        scores.put("Charlie", 70);

        // Lá»c nhá»¯ng ngÆ°á»i cÃ³ Ä‘iá»ƒm >= 80
        Map<String, Integer> highScores = scores.entrySet()
            .stream()
            .filter(entry -> entry.getValue() >= 80)
            .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue));

        System.out.println(highScores);
    }
}
```
ğŸŸ¢ Sáº¯p Xáº¿p `Map`
```java
Map<String, Integer> sortedMap = scores.entrySet()
    .stream()
    .sorted(Map.Entry.comparingByValue())
    .collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue, (e1, e2) -> e1, LinkedHashMap::new));

System.out.println(sortedMap);
```

## ğŸ”¹ 7. Hiá»‡u NÄƒng Cá»§a `Map`

|Loáº¡i `Map`|Lookup (get)|Insert (put)|Remove|
|---|---|---|---|
|`HashMap`|O(1)|O(1)|O(1)|
|`TreeMap`|O(log n)|O(log n)|O(log n)|
|`LinkedHashMap`|O(1)|O(1)|O(1)|
|`ConcurrentHashMap`|O(1)|O(1)|O(1)|

---
# **Map ÄÆ°á»£c LÆ°u á» ÄÃ¢u TrÃªn Bá»™ Nhá»›?** ğŸ§ ğŸ’¾

Viá»‡c `Map` Ä‘Æ°á»£c lÆ°u trá»¯ á»Ÿ Ä‘Ã¢u trong bá»™ nhá»› phá»¥ thuá»™c vÃ o **loáº¡i `Map` báº¡n sá»­ dá»¥ng**, cÃ¡ch báº¡n khai bÃ¡o biáº¿n, vÃ  bá»™ nhá»› heap/stack cá»§a JVM.

## **1ï¸âƒ£ Tá»•ng Quan Bá»™ Nhá»› Trong Java**

Java cÃ³ hai vÃ¹ng nhá»› chÃ­nh liÃªn quan Ä‘áº¿n `Map`:

|**VÃ¹ng nhá»›**|**Äáº·c Ä‘iá»ƒm**|**Map liÃªn quan**|
|---|---|---|
|**Stack** ğŸ—‚|LÆ°u biáº¿n cá»¥c bá»™ (local variables), quáº£n lÃ½ bá»Ÿi scope.|Biáº¿n tham chiáº¿u Ä‘áº¿n `Map` (chá»‰ lÆ°u Ä‘á»‹a chá»‰).|
|**Heap** ğŸ—|LÆ°u Ä‘á»‘i tÆ°á»£ng (`new`), quáº£n lÃ½ bá»Ÿi GC.|Äá»‘i tÆ°á»£ng `Map` thá»±c táº¿.|

VÃ­ dá»¥:

`Map<String, Integer> map = new HashMap<>();`

- `map` (biáº¿n tham chiáº¿u) Ä‘Æ°á»£c lÆ°u trong **Stack**.
- Äá»‘i tÆ°á»£ng `HashMap` (dá»¯ liá»‡u thá»±c táº¿) Ä‘Æ°á»£c cáº¥p phÃ¡t trÃªn **Heap**.

## **2ï¸âƒ£ Chi Tiáº¿t Bá»™ Nhá»› Cá»§a `HashMap`**

### ğŸŸ¢ **Cáº¥u TrÃºc BÃªn Trong `HashMap`**

`HashMap` lÆ°u dá»¯ liá»‡u theo kiá»ƒu **máº£ng + danh sÃ¡ch liÃªn káº¿t** (Array + LinkedList) hoáº·c **máº£ng + cÃ¢y Ä‘á» Ä‘en** (TreeMap khi collision lá»›n).

|ThÃ nh pháº§n|Äáº·c Ä‘iá»ƒm|
|---|---|
|**Table (Bucket Array)**|Máº£ng lÆ°u trá»¯ cÃ¡c Node (má»—i Node chá»©a Key-Value).|
|**Node (Entry<K, V>)**|Chá»©a cáº·p `key-value`, `hash`, `next` (liÃªn káº¿t).|
|**Tree (TreeNode<K, V>)**|Khi collision quÃ¡ nhiá»u, danh sÃ¡ch chuyá»ƒn thÃ nh cÃ¢y Ä‘á»-Ä‘en.|

### ğŸ”¹ **VÃ­ Dá»¥:**
```java
Map<String, Integer> map = new HashMap<>();
map.put("Alice", 25);
map.put("Bob", 30);
```

ğŸ“Œ **LÆ°u trong bá»™ nhá»› nhÆ° sau**:

1. `Alice.hashCode()` tÃ­nh ra index trong bucket.
2. `Bob.hashCode()` tÃ­nh ra index khÃ¡c hoáº·c trÃ¹ng (dáº«n Ä‘áº¿n collision).
3. Náº¿u collision:
    - DÆ°á»›i 8 pháº§n tá»­: DÃ¹ng danh sÃ¡ch liÃªn káº¿t.
    - TrÃªn 8 pháº§n tá»­: DÃ¹ng cÃ¢y Ä‘á»-Ä‘en.
ğŸ“Œ **SÆ¡ Äá»“ HashMap Trong Bá»™ Nhá»›**
```java
[Bucket 0] -> null
[Bucket 1] -> (Alice, 25) -> null
[Bucket 2] -> (Bob, 30) -> null
...
```

